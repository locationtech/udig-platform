<html>
    <head>
        <title>UDIG Developer Guide : Layer Summary Operation</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body BGCOLOR="#FFFFFF">
        <!-- UDIG Developer Guide : Layer Summary Operation -->

	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%">
		    <tr>
			    <td valign="top" class="pagebody">

				    <h2><a name="LayerSummaryOperation-LayerSummaryOperation">Layer Summary Operation</a></h2>

<h4><a name="LayerSummaryOperation-Plugin.xmlextensiondeclaration">Plugin.xml extension declaration</a></h4>
<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;extension
   point=<span class="code-quote">"net.refractions.udig.ui.operation"</span>&gt;
   &lt;operation
      targetClass=<span class="code-quote">"net.refractions.udig.project.ILayer"</span>
      class=<span class="code-quote">"net.refractions.udig.project.ui.LayerSummary"</span>
      categoryId=<span class="code-quote">"net.refractions.udig.project.ui.informationOperations"</span>
      name=<span class="code-quote">"Layer Summary"</span>
      id=<span class="code-quote">"net.refractions.udig.project.ui.Operation1"</span>/&gt;
   &lt;category
      name=<span class="code-quote">"Information"</span>
      id=<span class="code-quote">"net.refractions.udig.project.ui.informationOperations"</span>/&gt;
<span class="code-tag">&lt;/extension&gt;</span></pre>
</div></div>

<p>The <b>targetClass</b> indicates which type of objects the operation can operate on.  The an instance of the targetClass will be passed to the operation as one of the parameters of the op(...) method.<br/>
The <b>class</b> declares the operation class.  It must implement the IOp interface.  <br/>
The <b>categoryId</b> declares which category the operation is part of.  This determines where in the operations menu the operation is located.</p>

<p>The <b>category</b> declaration declares a new category called Information.  If there are any operations in the category the category will appear in all the Operations menus.</p>


<h4><a name="LayerSummaryOperation-LayerSummaryClass">Layer Summary Class</a></h4>

<div class="code" style="border-style: solid; "><div class="codeHeader" style="border-bottom-style: solid; "><b>LayerSummary.java</b></div><div class="codeContent">
<pre class="code-java">/**
 * Displays a summary of the layer in a dialog.
 *
 * @author jeichar
 * @since 0.6.0
 */
<span class="code-keyword">public</span> class LayerSummary <span class="code-keyword">implements</span> IOp {
	/**
	 * @see net.refractions.udig.ui.operations.IOp#op(org.eclipse.swt.widgets.Display,
         * java.lang.<span class="code-object">Object</span>, org.eclipse.core.runtime.IProgressMonitor)
	 */
	<span class="code-keyword">public</span> void op(<span class="code-keyword">final</span> Display display, <span class="code-object">Object</span> target, IProgressMonitor monitor) <span class="code-keyword">throws</span> Exception {
           <span class="code-keyword">final</span> Layer layer=(Layer) target;
	   monitor.beginTask(<span class="code-quote">"Layer Summary"</span>, 1);
           Envelope bounds=layer.getBounds(monitor, layer.getMap().getViewportModel().getCRS());
           <span class="code-keyword">final</span> <span class="code-object">StringBuffer</span> buffer=<span class="code-keyword">new</span> <span class="code-object">StringBuffer</span>();
           buffer.append(<span class="code-quote">"Name: "</span>+layer.getName()+<span class="code-quote">"\n"</span>);
           buffer.append(<span class="code-quote">"ID: "</span>+layer.getID()+<span class="code-quote">"\n"</span>);
           buffer.append(<span class="code-quote">"z-order: "</span>+layer.getZorder()+<span class="code-quote">"\n"</span>);
           buffer.append(<span class="code-quote">"Data CRS: "</span>+layer.getCRS(monitor).getName()+<span class="code-quote">"\n"</span>);
           buffer.append(<span class="code-quote">"Bounds: ("</span>+bounds.getMinX()+<span class="code-quote">","</span>+bounds.getMinY()+<span class="code-quote">")\n"</span>);
           buffer.append(<span class="code-quote">"            ("</span>+bounds.getMaxX()+<span class="code-quote">","</span>+bounds.getMaxY()+<span class="code-quote">"\n"</span>);
           buffer.append(<span class="code-quote">"Selection Filter: "</span>+layer.getFilter()+<span class="code-quote">"\n"</span>);
           display.asyncExec(<span class="code-keyword">new</span> <span class="code-object">Runnable</span>() {
			<span class="code-keyword">public</span> void run() {
		        MessageDialog.openInformation(display.getActiveShell(), <span class="code-quote">"Summary of "</span>+
                               layer.getName(), buffer.toString());
			}
		});
	   monitor.internalWorked(1);
	   monitor.done();
        }

}</pre>
</div></div>

<p>The parameter <b>display</b> is a display object the operation can use in order to interact with the User interface.  The <b>target</b> parameter is guaranteed to be of the same type declared in the targetClass attribute of the xml extension declaration.  The <b>monitor</b> parameter allows the operation to provide feedback to the UI on how much of the operation has been completed.</p>


                    			    </td>
		    </tr>
	    </table>

	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
		    <tr>
			    <td align="center">
<div float="left">
   <a href="http://udig.refractions.net/confluence/pages/viewpage.action?pageId=4369">[view]</a>
   <a href="http://udig.refractions.net/confluence/pages/editpage.action?pageId=4369">[edit]</a>
</div>
<font color="grey">
    <small>(c) Copyright (c) 2004,2005 Refractions Research Inc. and others.</small>
</font>
                            </td>
		    </tr>
	    </table>

    </body>
</html>
